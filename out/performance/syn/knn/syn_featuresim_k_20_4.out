Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 20
Generating top 20 dataset
Generating top 20 dataset
Generating top 20 dataset
Preparing time (sec): 6
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-30-13-49-51
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:2
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-30-13-49-51.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7f6d68e9ce80>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7f6d68e9ceb0>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=20
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=20
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6557, Val 0.6431, Test 0.6408
          Accuracy         : Train 0.5959, Val 0.6161, Test 0.6213
Best:
          Accuracy         : Train 0.5959, Val 0.6161, Test 0.6213
Epoch 2: Loss:            : Train 0.6343, Val 0.6414, Test 0.6379
          Accuracy         : Train 0.6304, Val 0.6197, Test 0.6243
Best:
          Accuracy         : Train 0.6304, Val 0.6197, Test 0.6243
Epoch 3: Loss:            : Train 0.6263, Val 0.6336, Test 0.6313
          Accuracy         : Train 0.6396, Val 0.6284, Test 0.6301
Best:
          Accuracy         : Train 0.6396, Val 0.6284, Test 0.6301
Epoch 4: Loss:            : Train 0.6203, Val 0.6358, Test 0.6309
          Accuracy         : Train 0.6457, Val 0.6266, Test 0.6310
Best:
          Accuracy         : Train 0.6396, Val 0.6284, Test 0.6301
Epoch 5: Loss:            : Train 0.6138, Val 0.6319, Test 0.6273
          Accuracy         : Train 0.6539, Val 0.6300, Test 0.6358
Best:
          Accuracy         : Train 0.6539, Val 0.6300, Test 0.6358
Epoch 6: Loss:            : Train 0.6084, Val 0.6388, Test 0.6343
          Accuracy         : Train 0.6588, Val 0.6290, Test 0.6320
Best:
          Accuracy         : Train 0.6539, Val 0.6300, Test 0.6358
Epoch 7: Loss:            : Train 0.6042, Val 0.6324, Test 0.6260
          Accuracy         : Train 0.6640, Val 0.6318, Test 0.6371
Best:
          Accuracy         : Train 0.6640, Val 0.6318, Test 0.6371
Epoch 8: Loss:            : Train 0.5994, Val 0.6381, Test 0.6305
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 9: Loss:            : Train 0.5958, Val 0.6446, Test 0.6363
          Accuracy         : Train 0.6712, Val 0.6243, Test 0.6304
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 10: Loss:            : Train 0.5919, Val 0.6383, Test 0.6325
          Accuracy         : Train 0.6751, Val 0.6295, Test 0.6331
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 11: Loss:            : Train 0.5883, Val 0.6449, Test 0.6357
          Accuracy         : Train 0.6791, Val 0.6261, Test 0.6297
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 12: Loss:            : Train 0.5849, Val 0.6479, Test 0.6390
          Accuracy         : Train 0.6814, Val 0.6268, Test 0.6328
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 13: Loss:            : Train 0.5823, Val 0.6452, Test 0.6354
          Accuracy         : Train 0.6843, Val 0.6265, Test 0.6337
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 14: Loss:            : Train 0.5793, Val 0.6446, Test 0.6352
          Accuracy         : Train 0.6868, Val 0.6285, Test 0.6339
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 15: Loss:            : Train 0.5763, Val 0.6533, Test 0.6455
          Accuracy         : Train 0.6899, Val 0.6217, Test 0.6244
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 16: Loss:            : Train 0.5734, Val 0.6511, Test 0.6424
          Accuracy         : Train 0.6930, Val 0.6270, Test 0.6298
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 17: Loss:            : Train 0.5694, Val 0.6516, Test 0.6397
          Accuracy         : Train 0.6978, Val 0.6306, Test 0.6347
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 18: Loss:            : Train 0.5667, Val 0.6590, Test 0.6482
          Accuracy         : Train 0.6985, Val 0.6236, Test 0.6283
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 19: Loss:            : Train 0.5639, Val 0.6607, Test 0.6489
          Accuracy         : Train 0.7000, Val 0.6246, Test 0.6305
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 20: Loss:            : Train 0.5615, Val 0.6673, Test 0.6534
          Accuracy         : Train 0.7047, Val 0.6229, Test 0.6297
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 21: Loss:            : Train 0.5587, Val 0.6627, Test 0.6526
          Accuracy         : Train 0.7061, Val 0.6221, Test 0.6283
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 22: Loss:            : Train 0.5565, Val 0.6641, Test 0.6535
          Accuracy         : Train 0.7076, Val 0.6218, Test 0.6243
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 23: Loss:            : Train 0.5528, Val 0.6803, Test 0.6662
          Accuracy         : Train 0.7111, Val 0.6205, Test 0.6288
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 24: Loss:            : Train 0.5507, Val 0.6757, Test 0.6614
          Accuracy         : Train 0.7132, Val 0.6203, Test 0.6304
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 25: Loss:            : Train 0.5481, Val 0.6765, Test 0.6662
          Accuracy         : Train 0.7146, Val 0.6227, Test 0.6233
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 26: Loss:            : Train 0.5451, Val 0.6741, Test 0.6631
          Accuracy         : Train 0.7171, Val 0.6222, Test 0.6261
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 27: Loss:            : Train 0.5430, Val 0.6832, Test 0.6684
          Accuracy         : Train 0.7190, Val 0.6153, Test 0.6232
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 28: Loss:            : Train 0.5397, Val 0.7086, Test 0.6941
          Accuracy         : Train 0.7208, Val 0.6077, Test 0.6189
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 29: Loss:            : Train 0.5369, Val 0.7006, Test 0.6877
          Accuracy         : Train 0.7236, Val 0.6083, Test 0.6144
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 30: Loss:            : Train 0.5358, Val 0.7004, Test 0.6863
          Accuracy         : Train 0.7238, Val 0.6146, Test 0.6264
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 31: Loss:            : Train 0.5332, Val 0.6945, Test 0.6787
          Accuracy         : Train 0.7273, Val 0.6118, Test 0.6249
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 32: Loss:            : Train 0.5304, Val 0.7047, Test 0.6869
          Accuracy         : Train 0.7284, Val 0.6045, Test 0.6171
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 33: Loss:            : Train 0.5288, Val 0.6945, Test 0.6802
          Accuracy         : Train 0.7287, Val 0.6073, Test 0.6184
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 34: Loss:            : Train 0.5257, Val 0.7039, Test 0.6890
          Accuracy         : Train 0.7321, Val 0.6099, Test 0.6200
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 35: Loss:            : Train 0.5229, Val 0.7059, Test 0.6888
          Accuracy         : Train 0.7344, Val 0.6082, Test 0.6223
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 36: Loss:            : Train 0.5194, Val 0.7208, Test 0.7077
          Accuracy         : Train 0.7375, Val 0.6064, Test 0.6186
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 37: Loss:            : Train 0.5168, Val 0.7178, Test 0.7055
          Accuracy         : Train 0.7366, Val 0.6064, Test 0.6142
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 38: Loss:            : Train 0.5148, Val 0.7228, Test 0.7013
          Accuracy         : Train 0.7399, Val 0.6055, Test 0.6185
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 39: Loss:            : Train 0.5122, Val 0.7216, Test 0.7005
          Accuracy         : Train 0.7415, Val 0.6012, Test 0.6157
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 40: Loss:            : Train 0.5095, Val 0.7342, Test 0.7148
          Accuracy         : Train 0.7434, Val 0.5981, Test 0.6145
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 41: Loss:            : Train 0.5062, Val 0.7509, Test 0.7262
          Accuracy         : Train 0.7448, Val 0.6022, Test 0.6177
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 42: Loss:            : Train 0.5041, Val 0.7496, Test 0.7285
          Accuracy         : Train 0.7470, Val 0.5999, Test 0.6112
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 43: Loss:            : Train 0.5015, Val 0.7480, Test 0.7262
          Accuracy         : Train 0.7491, Val 0.6012, Test 0.6134
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 44: Loss:            : Train 0.4976, Val 0.7692, Test 0.7476
          Accuracy         : Train 0.7527, Val 0.6046, Test 0.6165
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 45: Loss:            : Train 0.4956, Val 0.7595, Test 0.7306
          Accuracy         : Train 0.7516, Val 0.5948, Test 0.6130
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 46: Loss:            : Train 0.4930, Val 0.7749, Test 0.7477
          Accuracy         : Train 0.7549, Val 0.6028, Test 0.6148
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 47: Loss:            : Train 0.4903, Val 0.7702, Test 0.7503
          Accuracy         : Train 0.7566, Val 0.5928, Test 0.6099
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 48: Loss:            : Train 0.4859, Val 0.7799, Test 0.7571
          Accuracy         : Train 0.7592, Val 0.5982, Test 0.6098
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 49: Loss:            : Train 0.4839, Val 0.7963, Test 0.7703
          Accuracy         : Train 0.7598, Val 0.5983, Test 0.6086
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Epoch 50: Loss:            : Train 0.4819, Val 0.7961, Test 0.7687
          Accuracy         : Train 0.7625, Val 0.5946, Test 0.6107
Best:
          Accuracy         : Train 0.6684, Val 0.6331, Test 0.6348
Training time (sec): 1591
