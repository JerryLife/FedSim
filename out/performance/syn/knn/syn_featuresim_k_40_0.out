Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 40
Generating top 40 dataset
Generating top 40 dataset
Generating top 40 dataset
Preparing time (sec): 65
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-30-02-33-50
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:2
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-30-02-33-50.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7f6853fcfbb0>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7f6853fcfbe0>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=40
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=40
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6580, Val 0.6469, Test 0.6424
          Accuracy         : Train 0.5949, Val 0.6131, Test 0.6159
Best:
          Accuracy         : Train 0.5949, Val 0.6131, Test 0.6159
Epoch 2: Loss:            : Train 0.6369, Val 0.6413, Test 0.6388
          Accuracy         : Train 0.6258, Val 0.6167, Test 0.6199
Best:
          Accuracy         : Train 0.6258, Val 0.6167, Test 0.6199
Epoch 3: Loss:            : Train 0.6304, Val 0.6393, Test 0.6363
          Accuracy         : Train 0.6347, Val 0.6218, Test 0.6215
Best:
          Accuracy         : Train 0.6347, Val 0.6218, Test 0.6215
Epoch 4: Loss:            : Train 0.6253, Val 0.6396, Test 0.6360
          Accuracy         : Train 0.6399, Val 0.6215, Test 0.6251
Best:
          Accuracy         : Train 0.6347, Val 0.6218, Test 0.6215
Epoch 5: Loss:            : Train 0.6210, Val 0.6383, Test 0.6332
          Accuracy         : Train 0.6456, Val 0.6216, Test 0.6276
Best:
          Accuracy         : Train 0.6347, Val 0.6218, Test 0.6215
Epoch 6: Loss:            : Train 0.6156, Val 0.6422, Test 0.6354
          Accuracy         : Train 0.6511, Val 0.6209, Test 0.6251
Best:
          Accuracy         : Train 0.6347, Val 0.6218, Test 0.6215
Epoch 7: Loss:            : Train 0.6104, Val 0.6363, Test 0.6317
          Accuracy         : Train 0.6574, Val 0.6265, Test 0.6316
Best:
          Accuracy         : Train 0.6574, Val 0.6265, Test 0.6316
Epoch 8: Loss:            : Train 0.6049, Val 0.6358, Test 0.6295
          Accuracy         : Train 0.6625, Val 0.6284, Test 0.6326
Best:
          Accuracy         : Train 0.6625, Val 0.6284, Test 0.6326
Epoch 9: Loss:            : Train 0.5994, Val 0.6381, Test 0.6318
          Accuracy         : Train 0.6684, Val 0.6265, Test 0.6321
Best:
          Accuracy         : Train 0.6625, Val 0.6284, Test 0.6326
Epoch 10: Loss:            : Train 0.5948, Val 0.6437, Test 0.6395
          Accuracy         : Train 0.6729, Val 0.6304, Test 0.6333
Best:
          Accuracy         : Train 0.6729, Val 0.6304, Test 0.6333
Epoch 11: Loss:            : Train 0.5900, Val 0.6402, Test 0.6330
          Accuracy         : Train 0.6794, Val 0.6272, Test 0.6362
Best:
          Accuracy         : Train 0.6729, Val 0.6304, Test 0.6333
Epoch 12: Loss:            : Train 0.5854, Val 0.6424, Test 0.6379
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 13: Loss:            : Train 0.5818, Val 0.6465, Test 0.6416
          Accuracy         : Train 0.6857, Val 0.6272, Test 0.6320
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 14: Loss:            : Train 0.5774, Val 0.6517, Test 0.6446
          Accuracy         : Train 0.6914, Val 0.6240, Test 0.6302
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 15: Loss:            : Train 0.5740, Val 0.6505, Test 0.6419
          Accuracy         : Train 0.6925, Val 0.6219, Test 0.6340
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 16: Loss:            : Train 0.5703, Val 0.6496, Test 0.6471
          Accuracy         : Train 0.6959, Val 0.6283, Test 0.6290
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 17: Loss:            : Train 0.5666, Val 0.6552, Test 0.6490
          Accuracy         : Train 0.6978, Val 0.6242, Test 0.6306
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 18: Loss:            : Train 0.5633, Val 0.6568, Test 0.6485
          Accuracy         : Train 0.7013, Val 0.6211, Test 0.6269
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 19: Loss:            : Train 0.5593, Val 0.6579, Test 0.6517
          Accuracy         : Train 0.7047, Val 0.6255, Test 0.6305
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 20: Loss:            : Train 0.5569, Val 0.6638, Test 0.6570
          Accuracy         : Train 0.7081, Val 0.6207, Test 0.6269
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 21: Loss:            : Train 0.5536, Val 0.6669, Test 0.6636
          Accuracy         : Train 0.7107, Val 0.6212, Test 0.6204
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 22: Loss:            : Train 0.5499, Val 0.6654, Test 0.6607
          Accuracy         : Train 0.7129, Val 0.6162, Test 0.6230
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 23: Loss:            : Train 0.5479, Val 0.6556, Test 0.6541
          Accuracy         : Train 0.7159, Val 0.6206, Test 0.6253
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 24: Loss:            : Train 0.5449, Val 0.6729, Test 0.6702
          Accuracy         : Train 0.7179, Val 0.6185, Test 0.6204
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 25: Loss:            : Train 0.5421, Val 0.6806, Test 0.6770
          Accuracy         : Train 0.7215, Val 0.6146, Test 0.6219
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 26: Loss:            : Train 0.5396, Val 0.6811, Test 0.6780
          Accuracy         : Train 0.7214, Val 0.6143, Test 0.6243
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 27: Loss:            : Train 0.5372, Val 0.7016, Test 0.6955
          Accuracy         : Train 0.7225, Val 0.6162, Test 0.6248
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 28: Loss:            : Train 0.5346, Val 0.6809, Test 0.6789
          Accuracy         : Train 0.7250, Val 0.6124, Test 0.6216
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 29: Loss:            : Train 0.5314, Val 0.6905, Test 0.6818
          Accuracy         : Train 0.7283, Val 0.6103, Test 0.6193
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 30: Loss:            : Train 0.5297, Val 0.6951, Test 0.6932
          Accuracy         : Train 0.7284, Val 0.6089, Test 0.6157
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 31: Loss:            : Train 0.5257, Val 0.7031, Test 0.7027
          Accuracy         : Train 0.7319, Val 0.6121, Test 0.6201
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 32: Loss:            : Train 0.5229, Val 0.6928, Test 0.6951
          Accuracy         : Train 0.7335, Val 0.6113, Test 0.6164
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 33: Loss:            : Train 0.5212, Val 0.7161, Test 0.7094
          Accuracy         : Train 0.7357, Val 0.6050, Test 0.6151
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 34: Loss:            : Train 0.5181, Val 0.7191, Test 0.7171
          Accuracy         : Train 0.7356, Val 0.6152, Test 0.6161
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 35: Loss:            : Train 0.5157, Val 0.7212, Test 0.7181
          Accuracy         : Train 0.7383, Val 0.6155, Test 0.6162
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 36: Loss:            : Train 0.5128, Val 0.7182, Test 0.7152
          Accuracy         : Train 0.7414, Val 0.6078, Test 0.6128
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 37: Loss:            : Train 0.5100, Val 0.7172, Test 0.7201
          Accuracy         : Train 0.7428, Val 0.6112, Test 0.6150
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 38: Loss:            : Train 0.5064, Val 0.7324, Test 0.7301
          Accuracy         : Train 0.7461, Val 0.6103, Test 0.6132
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 39: Loss:            : Train 0.5042, Val 0.7313, Test 0.7260
          Accuracy         : Train 0.7469, Val 0.6070, Test 0.6153
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 40: Loss:            : Train 0.5027, Val 0.7427, Test 0.7371
          Accuracy         : Train 0.7489, Val 0.6045, Test 0.6129
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 41: Loss:            : Train 0.4987, Val 0.7383, Test 0.7370
          Accuracy         : Train 0.7509, Val 0.6052, Test 0.6098
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 42: Loss:            : Train 0.4949, Val 0.7536, Test 0.7533
          Accuracy         : Train 0.7539, Val 0.6071, Test 0.6150
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 43: Loss:            : Train 0.4920, Val 0.7655, Test 0.7674
          Accuracy         : Train 0.7568, Val 0.6073, Test 0.6142
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 44: Loss:            : Train 0.4889, Val 0.7578, Test 0.7538
          Accuracy         : Train 0.7572, Val 0.5965, Test 0.6055
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 45: Loss:            : Train 0.4860, Val 0.7595, Test 0.7608
          Accuracy         : Train 0.7609, Val 0.6004, Test 0.6049
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 46: Loss:            : Train 0.4822, Val 0.7634, Test 0.7682
          Accuracy         : Train 0.7625, Val 0.6034, Test 0.6078
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 47: Loss:            : Train 0.4786, Val 0.7790, Test 0.7791
          Accuracy         : Train 0.7665, Val 0.5992, Test 0.6032
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 48: Loss:            : Train 0.4750, Val 0.8036, Test 0.8034
          Accuracy         : Train 0.7669, Val 0.6009, Test 0.6048
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 49: Loss:            : Train 0.4722, Val 0.7902, Test 0.7929
          Accuracy         : Train 0.7697, Val 0.5921, Test 0.6054
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Epoch 50: Loss:            : Train 0.4687, Val 0.7892, Test 0.7904
          Accuracy         : Train 0.7724, Val 0.6008, Test 0.6074
Best:
          Accuracy         : Train 0.6811, Val 0.6313, Test 0.6348
Training time (sec): 1621
