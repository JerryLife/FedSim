Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 100
Generating top 100 dataset
Generating top 100 dataset
Generating top 100 dataset
Preparing time (sec): 16
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-29-12-05-49
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:1
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-29-12-05-49.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7f19d94e5190>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7f19d94e5160>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=100
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=100
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6598, Val 0.6481, Test 0.6461
          Accuracy         : Train 0.5935, Val 0.6080, Test 0.6119
Best:
          Accuracy         : Train 0.5935, Val 0.6080, Test 0.6119
Epoch 2: Loss:            : Train 0.6365, Val 0.6476, Test 0.6436
          Accuracy         : Train 0.6276, Val 0.6057, Test 0.6110
Best:
          Accuracy         : Train 0.5935, Val 0.6080, Test 0.6119
Epoch 3: Loss:            : Train 0.6302, Val 0.6425, Test 0.6373
          Accuracy         : Train 0.6346, Val 0.6158, Test 0.6224
Best:
          Accuracy         : Train 0.6346, Val 0.6158, Test 0.6224
Epoch 4: Loss:            : Train 0.6246, Val 0.6371, Test 0.6336
          Accuracy         : Train 0.6428, Val 0.6225, Test 0.6272
Best:
          Accuracy         : Train 0.6428, Val 0.6225, Test 0.6272
Epoch 5: Loss:            : Train 0.6191, Val 0.6383, Test 0.6327
          Accuracy         : Train 0.6481, Val 0.6247, Test 0.6314
Best:
          Accuracy         : Train 0.6481, Val 0.6247, Test 0.6314
Epoch 6: Loss:            : Train 0.6134, Val 0.6390, Test 0.6315
          Accuracy         : Train 0.6552, Val 0.6226, Test 0.6294
Best:
          Accuracy         : Train 0.6481, Val 0.6247, Test 0.6314
Epoch 7: Loss:            : Train 0.6089, Val 0.6337, Test 0.6266
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 8: Loss:            : Train 0.6038, Val 0.6364, Test 0.6274
          Accuracy         : Train 0.6665, Val 0.6249, Test 0.6375
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 9: Loss:            : Train 0.5996, Val 0.6393, Test 0.6289
          Accuracy         : Train 0.6696, Val 0.6263, Test 0.6333
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 10: Loss:            : Train 0.5944, Val 0.6386, Test 0.6315
          Accuracy         : Train 0.6733, Val 0.6254, Test 0.6355
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 11: Loss:            : Train 0.5899, Val 0.6439, Test 0.6320
          Accuracy         : Train 0.6788, Val 0.6222, Test 0.6332
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 12: Loss:            : Train 0.5859, Val 0.6420, Test 0.6326
          Accuracy         : Train 0.6813, Val 0.6185, Test 0.6324
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 13: Loss:            : Train 0.5822, Val 0.6470, Test 0.6373
          Accuracy         : Train 0.6847, Val 0.6246, Test 0.6337
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 14: Loss:            : Train 0.5780, Val 0.6475, Test 0.6373
          Accuracy         : Train 0.6876, Val 0.6242, Test 0.6344
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 15: Loss:            : Train 0.5739, Val 0.6511, Test 0.6432
          Accuracy         : Train 0.6923, Val 0.6202, Test 0.6268
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 16: Loss:            : Train 0.5710, Val 0.6508, Test 0.6416
          Accuracy         : Train 0.6942, Val 0.6213, Test 0.6327
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 17: Loss:            : Train 0.5672, Val 0.6532, Test 0.6442
          Accuracy         : Train 0.6962, Val 0.6210, Test 0.6291
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 18: Loss:            : Train 0.5641, Val 0.6546, Test 0.6459
          Accuracy         : Train 0.6998, Val 0.6185, Test 0.6263
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 19: Loss:            : Train 0.5608, Val 0.6635, Test 0.6537
          Accuracy         : Train 0.7035, Val 0.6173, Test 0.6252
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 20: Loss:            : Train 0.5580, Val 0.6642, Test 0.6562
          Accuracy         : Train 0.7054, Val 0.6209, Test 0.6253
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 21: Loss:            : Train 0.5546, Val 0.6593, Test 0.6542
          Accuracy         : Train 0.7088, Val 0.6189, Test 0.6247
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 22: Loss:            : Train 0.5511, Val 0.6690, Test 0.6599
          Accuracy         : Train 0.7108, Val 0.6190, Test 0.6202
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 23: Loss:            : Train 0.5488, Val 0.6671, Test 0.6621
          Accuracy         : Train 0.7138, Val 0.6189, Test 0.6228
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 24: Loss:            : Train 0.5459, Val 0.6881, Test 0.6742
          Accuracy         : Train 0.7142, Val 0.6056, Test 0.6192
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 25: Loss:            : Train 0.5429, Val 0.6804, Test 0.6719
          Accuracy         : Train 0.7174, Val 0.6177, Test 0.6245
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 26: Loss:            : Train 0.5397, Val 0.6931, Test 0.6879
          Accuracy         : Train 0.7205, Val 0.6220, Test 0.6229
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 27: Loss:            : Train 0.5377, Val 0.6846, Test 0.6804
          Accuracy         : Train 0.7210, Val 0.6171, Test 0.6255
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 28: Loss:            : Train 0.5345, Val 0.6950, Test 0.6854
          Accuracy         : Train 0.7229, Val 0.6154, Test 0.6271
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 29: Loss:            : Train 0.5324, Val 0.6803, Test 0.6736
          Accuracy         : Train 0.7271, Val 0.6113, Test 0.6225
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 30: Loss:            : Train 0.5296, Val 0.6979, Test 0.6880
          Accuracy         : Train 0.7254, Val 0.6122, Test 0.6230
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 31: Loss:            : Train 0.5268, Val 0.6982, Test 0.6903
          Accuracy         : Train 0.7287, Val 0.6103, Test 0.6223
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 32: Loss:            : Train 0.5247, Val 0.6956, Test 0.6858
          Accuracy         : Train 0.7306, Val 0.6050, Test 0.6166
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 33: Loss:            : Train 0.5224, Val 0.6977, Test 0.6868
          Accuracy         : Train 0.7323, Val 0.6074, Test 0.6140
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 34: Loss:            : Train 0.5187, Val 0.6960, Test 0.6893
          Accuracy         : Train 0.7353, Val 0.6099, Test 0.6195
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 35: Loss:            : Train 0.5159, Val 0.7151, Test 0.7027
          Accuracy         : Train 0.7370, Val 0.6125, Test 0.6183
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 36: Loss:            : Train 0.5135, Val 0.7115, Test 0.7049
          Accuracy         : Train 0.7394, Val 0.6088, Test 0.6156
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 37: Loss:            : Train 0.5107, Val 0.7084, Test 0.7029
          Accuracy         : Train 0.7422, Val 0.6058, Test 0.6134
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 38: Loss:            : Train 0.5081, Val 0.7304, Test 0.7207
          Accuracy         : Train 0.7435, Val 0.6049, Test 0.6143
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 39: Loss:            : Train 0.5058, Val 0.7216, Test 0.7132
          Accuracy         : Train 0.7461, Val 0.6094, Test 0.6183
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 40: Loss:            : Train 0.5031, Val 0.7261, Test 0.7220
          Accuracy         : Train 0.7472, Val 0.6070, Test 0.6157
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 41: Loss:            : Train 0.5001, Val 0.7330, Test 0.7249
          Accuracy         : Train 0.7504, Val 0.5995, Test 0.6135
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 42: Loss:            : Train 0.4978, Val 0.7483, Test 0.7376
          Accuracy         : Train 0.7517, Val 0.6034, Test 0.6125
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 43: Loss:            : Train 0.4949, Val 0.7456, Test 0.7458
          Accuracy         : Train 0.7539, Val 0.6053, Test 0.6108
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 44: Loss:            : Train 0.4921, Val 0.7434, Test 0.7355
          Accuracy         : Train 0.7559, Val 0.5960, Test 0.6120
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 45: Loss:            : Train 0.4894, Val 0.7773, Test 0.7689
          Accuracy         : Train 0.7558, Val 0.5970, Test 0.6076
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 46: Loss:            : Train 0.4850, Val 0.7581, Test 0.7504
          Accuracy         : Train 0.7607, Val 0.6056, Test 0.6166
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 47: Loss:            : Train 0.4835, Val 0.7588, Test 0.7481
          Accuracy         : Train 0.7619, Val 0.6001, Test 0.6098
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 48: Loss:            : Train 0.4806, Val 0.7692, Test 0.7665
          Accuracy         : Train 0.7628, Val 0.6075, Test 0.6130
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 49: Loss:            : Train 0.4768, Val 0.7882, Test 0.7748
          Accuracy         : Train 0.7647, Val 0.5954, Test 0.6082
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Epoch 50: Loss:            : Train 0.4740, Val 0.7836, Test 0.7730
          Accuracy         : Train 0.7676, Val 0.6007, Test 0.6108
Best:
          Accuracy         : Train 0.6586, Val 0.6268, Test 0.6374
Training time (sec): 3063
