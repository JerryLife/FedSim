Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Preparing time (sec): 3
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-30-06-34-10
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:0
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-30-06-34-10.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7f305bf0ca60>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7f305bf0cac0>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=100
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=None
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6569, Val 0.6478, Test 0.6430
          Accuracy         : Train 0.5951, Val 0.6058, Test 0.6158
Best:
          Accuracy         : Train 0.5951, Val 0.6058, Test 0.6158
Epoch 2: Loss:            : Train 0.6358, Val 0.6427, Test 0.6394
          Accuracy         : Train 0.6289, Val 0.6150, Test 0.6219
Best:
          Accuracy         : Train 0.6289, Val 0.6150, Test 0.6219
Epoch 3: Loss:            : Train 0.6295, Val 0.6392, Test 0.6363
          Accuracy         : Train 0.6367, Val 0.6146, Test 0.6194
Best:
          Accuracy         : Train 0.6289, Val 0.6150, Test 0.6219
Epoch 4: Loss:            : Train 0.6254, Val 0.6375, Test 0.6346
          Accuracy         : Train 0.6412, Val 0.6222, Test 0.6258
Best:
          Accuracy         : Train 0.6412, Val 0.6222, Test 0.6258
Epoch 5: Loss:            : Train 0.6206, Val 0.6395, Test 0.6350
          Accuracy         : Train 0.6473, Val 0.6223, Test 0.6246
Best:
          Accuracy         : Train 0.6473, Val 0.6223, Test 0.6246
Epoch 6: Loss:            : Train 0.6157, Val 0.6377, Test 0.6305
          Accuracy         : Train 0.6511, Val 0.6256, Test 0.6323
Best:
          Accuracy         : Train 0.6511, Val 0.6256, Test 0.6323
Epoch 7: Loss:            : Train 0.6106, Val 0.6370, Test 0.6307
          Accuracy         : Train 0.6570, Val 0.6249, Test 0.6328
Best:
          Accuracy         : Train 0.6511, Val 0.6256, Test 0.6323
Epoch 8: Loss:            : Train 0.6066, Val 0.6442, Test 0.6324
          Accuracy         : Train 0.6614, Val 0.6248, Test 0.6318
Best:
          Accuracy         : Train 0.6511, Val 0.6256, Test 0.6323
Epoch 9: Loss:            : Train 0.6019, Val 0.6412, Test 0.6293
          Accuracy         : Train 0.6665, Val 0.6274, Test 0.6340
Best:
          Accuracy         : Train 0.6665, Val 0.6274, Test 0.6340
Epoch 10: Loss:            : Train 0.5985, Val 0.6406, Test 0.6303
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 11: Loss:            : Train 0.5949, Val 0.6431, Test 0.6328
          Accuracy         : Train 0.6711, Val 0.6274, Test 0.6361
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 12: Loss:            : Train 0.5919, Val 0.6472, Test 0.6358
          Accuracy         : Train 0.6759, Val 0.6262, Test 0.6321
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 13: Loss:            : Train 0.5886, Val 0.6427, Test 0.6315
          Accuracy         : Train 0.6784, Val 0.6268, Test 0.6363
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 14: Loss:            : Train 0.5841, Val 0.6504, Test 0.6349
          Accuracy         : Train 0.6800, Val 0.6221, Test 0.6335
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 15: Loss:            : Train 0.5813, Val 0.6530, Test 0.6393
          Accuracy         : Train 0.6845, Val 0.6256, Test 0.6324
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 16: Loss:            : Train 0.5785, Val 0.6558, Test 0.6375
          Accuracy         : Train 0.6871, Val 0.6247, Test 0.6340
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 17: Loss:            : Train 0.5751, Val 0.6755, Test 0.6559
          Accuracy         : Train 0.6890, Val 0.6123, Test 0.6241
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 18: Loss:            : Train 0.5724, Val 0.6599, Test 0.6416
          Accuracy         : Train 0.6919, Val 0.6174, Test 0.6313
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 19: Loss:            : Train 0.5691, Val 0.6666, Test 0.6490
          Accuracy         : Train 0.6943, Val 0.6147, Test 0.6270
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 20: Loss:            : Train 0.5659, Val 0.6646, Test 0.6441
          Accuracy         : Train 0.6982, Val 0.6173, Test 0.6329
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 21: Loss:            : Train 0.5636, Val 0.6687, Test 0.6528
          Accuracy         : Train 0.7004, Val 0.6092, Test 0.6273
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 22: Loss:            : Train 0.5606, Val 0.6692, Test 0.6535
          Accuracy         : Train 0.7027, Val 0.6220, Test 0.6279
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 23: Loss:            : Train 0.5576, Val 0.6730, Test 0.6531
          Accuracy         : Train 0.7045, Val 0.6147, Test 0.6255
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 24: Loss:            : Train 0.5543, Val 0.6826, Test 0.6615
          Accuracy         : Train 0.7085, Val 0.6121, Test 0.6248
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 25: Loss:            : Train 0.5524, Val 0.6842, Test 0.6660
          Accuracy         : Train 0.7096, Val 0.6165, Test 0.6274
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 26: Loss:            : Train 0.5488, Val 0.6789, Test 0.6637
          Accuracy         : Train 0.7141, Val 0.6231, Test 0.6288
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 27: Loss:            : Train 0.5461, Val 0.6843, Test 0.6669
          Accuracy         : Train 0.7146, Val 0.6208, Test 0.6259
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 28: Loss:            : Train 0.5431, Val 0.6937, Test 0.6765
          Accuracy         : Train 0.7172, Val 0.6165, Test 0.6212
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 29: Loss:            : Train 0.5397, Val 0.6937, Test 0.6715
          Accuracy         : Train 0.7195, Val 0.6128, Test 0.6206
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 30: Loss:            : Train 0.5370, Val 0.7063, Test 0.6891
          Accuracy         : Train 0.7225, Val 0.6106, Test 0.6168
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 31: Loss:            : Train 0.5336, Val 0.7300, Test 0.7005
          Accuracy         : Train 0.7248, Val 0.6058, Test 0.6207
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 32: Loss:            : Train 0.5316, Val 0.6949, Test 0.6757
          Accuracy         : Train 0.7265, Val 0.6097, Test 0.6231
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 33: Loss:            : Train 0.5283, Val 0.7099, Test 0.6852
          Accuracy         : Train 0.7295, Val 0.6106, Test 0.6200
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 34: Loss:            : Train 0.5260, Val 0.7327, Test 0.7016
          Accuracy         : Train 0.7307, Val 0.6078, Test 0.6206
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 35: Loss:            : Train 0.5233, Val 0.7117, Test 0.6937
          Accuracy         : Train 0.7318, Val 0.6109, Test 0.6188
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 36: Loss:            : Train 0.5194, Val 0.7457, Test 0.7188
          Accuracy         : Train 0.7347, Val 0.5990, Test 0.6094
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 37: Loss:            : Train 0.5177, Val 0.7252, Test 0.7014
          Accuracy         : Train 0.7363, Val 0.6021, Test 0.6195
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 38: Loss:            : Train 0.5145, Val 0.7429, Test 0.7224
          Accuracy         : Train 0.7396, Val 0.6088, Test 0.6183
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 39: Loss:            : Train 0.5126, Val 0.7298, Test 0.7107
          Accuracy         : Train 0.7399, Val 0.6076, Test 0.6139
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 40: Loss:            : Train 0.5095, Val 0.7410, Test 0.7227
          Accuracy         : Train 0.7428, Val 0.6014, Test 0.6132
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 41: Loss:            : Train 0.5064, Val 0.7498, Test 0.7273
          Accuracy         : Train 0.7451, Val 0.6025, Test 0.6127
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 42: Loss:            : Train 0.5022, Val 0.7477, Test 0.7231
          Accuracy         : Train 0.7472, Val 0.6033, Test 0.6137
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 43: Loss:            : Train 0.4991, Val 0.7550, Test 0.7338
          Accuracy         : Train 0.7491, Val 0.6057, Test 0.6153
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 44: Loss:            : Train 0.4960, Val 0.7703, Test 0.7398
          Accuracy         : Train 0.7517, Val 0.5953, Test 0.6045
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 45: Loss:            : Train 0.4936, Val 0.7723, Test 0.7482
          Accuracy         : Train 0.7561, Val 0.6032, Test 0.6115
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 46: Loss:            : Train 0.4911, Val 0.7789, Test 0.7558
          Accuracy         : Train 0.7549, Val 0.5996, Test 0.6086
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 47: Loss:            : Train 0.4871, Val 0.7883, Test 0.7666
          Accuracy         : Train 0.7581, Val 0.5903, Test 0.6001
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 48: Loss:            : Train 0.4851, Val 0.7780, Test 0.7545
          Accuracy         : Train 0.7603, Val 0.5965, Test 0.6080
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 49: Loss:            : Train 0.4815, Val 0.7874, Test 0.7726
          Accuracy         : Train 0.7611, Val 0.6048, Test 0.6072
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Epoch 50: Loss:            : Train 0.4795, Val 0.7930, Test 0.7776
          Accuracy         : Train 0.7632, Val 0.6002, Test 0.6085
Best:
          Accuracy         : Train 0.6694, Val 0.6305, Test 0.6339
Training time (sec): 1687
