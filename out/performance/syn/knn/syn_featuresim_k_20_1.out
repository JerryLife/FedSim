Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 20
Generating top 20 dataset
Generating top 20 dataset
Generating top 20 dataset
Preparing time (sec): 7
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-30-05-01-18
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:2
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-30-05-01-18.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7fd005ddbbe0>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7fd005ddbc10>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=20
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=20
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6582, Val 0.6446, Test 0.6408
          Accuracy         : Train 0.5936, Val 0.6140, Test 0.6140
Best:
          Accuracy         : Train 0.5936, Val 0.6140, Test 0.6140
Epoch 2: Loss:            : Train 0.6358, Val 0.6383, Test 0.6354
          Accuracy         : Train 0.6271, Val 0.6214, Test 0.6228
Best:
          Accuracy         : Train 0.6271, Val 0.6214, Test 0.6228
Epoch 3: Loss:            : Train 0.6288, Val 0.6383, Test 0.6332
          Accuracy         : Train 0.6354, Val 0.6224, Test 0.6280
Best:
          Accuracy         : Train 0.6354, Val 0.6224, Test 0.6280
Epoch 4: Loss:            : Train 0.6225, Val 0.6339, Test 0.6292
          Accuracy         : Train 0.6440, Val 0.6296, Test 0.6314
Best:
          Accuracy         : Train 0.6440, Val 0.6296, Test 0.6314
Epoch 5: Loss:            : Train 0.6172, Val 0.6339, Test 0.6271
          Accuracy         : Train 0.6506, Val 0.6296, Test 0.6354
Best:
          Accuracy         : Train 0.6440, Val 0.6296, Test 0.6314
Epoch 6: Loss:            : Train 0.6121, Val 0.6337, Test 0.6251
          Accuracy         : Train 0.6551, Val 0.6300, Test 0.6390
Best:
          Accuracy         : Train 0.6551, Val 0.6300, Test 0.6390
Epoch 7: Loss:            : Train 0.6062, Val 0.6355, Test 0.6273
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 8: Loss:            : Train 0.6010, Val 0.6359, Test 0.6268
          Accuracy         : Train 0.6666, Val 0.6282, Test 0.6351
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 9: Loss:            : Train 0.5967, Val 0.6339, Test 0.6241
          Accuracy         : Train 0.6708, Val 0.6302, Test 0.6400
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 10: Loss:            : Train 0.5924, Val 0.6351, Test 0.6259
          Accuracy         : Train 0.6753, Val 0.6304, Test 0.6391
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 11: Loss:            : Train 0.5880, Val 0.6416, Test 0.6298
          Accuracy         : Train 0.6795, Val 0.6238, Test 0.6348
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 12: Loss:            : Train 0.5841, Val 0.6448, Test 0.6339
          Accuracy         : Train 0.6822, Val 0.6251, Test 0.6346
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 13: Loss:            : Train 0.5802, Val 0.6460, Test 0.6343
          Accuracy         : Train 0.6871, Val 0.6185, Test 0.6313
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 14: Loss:            : Train 0.5760, Val 0.6438, Test 0.6362
          Accuracy         : Train 0.6898, Val 0.6255, Test 0.6319
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 15: Loss:            : Train 0.5719, Val 0.6454, Test 0.6350
          Accuracy         : Train 0.6945, Val 0.6237, Test 0.6337
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 16: Loss:            : Train 0.5691, Val 0.6517, Test 0.6388
          Accuracy         : Train 0.6947, Val 0.6252, Test 0.6333
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 17: Loss:            : Train 0.5652, Val 0.6582, Test 0.6460
          Accuracy         : Train 0.6991, Val 0.6183, Test 0.6266
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 18: Loss:            : Train 0.5625, Val 0.6547, Test 0.6435
          Accuracy         : Train 0.7013, Val 0.6216, Test 0.6307
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 19: Loss:            : Train 0.5588, Val 0.6589, Test 0.6490
          Accuracy         : Train 0.7054, Val 0.6172, Test 0.6271
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 20: Loss:            : Train 0.5565, Val 0.6627, Test 0.6502
          Accuracy         : Train 0.7072, Val 0.6184, Test 0.6290
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 21: Loss:            : Train 0.5527, Val 0.6676, Test 0.6563
          Accuracy         : Train 0.7099, Val 0.6181, Test 0.6246
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 22: Loss:            : Train 0.5508, Val 0.6840, Test 0.6654
          Accuracy         : Train 0.7107, Val 0.6073, Test 0.6223
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 23: Loss:            : Train 0.5476, Val 0.6744, Test 0.6612
          Accuracy         : Train 0.7141, Val 0.6164, Test 0.6205
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 24: Loss:            : Train 0.5446, Val 0.6830, Test 0.6677
          Accuracy         : Train 0.7156, Val 0.6110, Test 0.6233
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 25: Loss:            : Train 0.5420, Val 0.6943, Test 0.6772
          Accuracy         : Train 0.7185, Val 0.6078, Test 0.6214
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 26: Loss:            : Train 0.5389, Val 0.6929, Test 0.6732
          Accuracy         : Train 0.7216, Val 0.6076, Test 0.6233
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 27: Loss:            : Train 0.5362, Val 0.6927, Test 0.6720
          Accuracy         : Train 0.7229, Val 0.6054, Test 0.6216
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 28: Loss:            : Train 0.5321, Val 0.6898, Test 0.6722
          Accuracy         : Train 0.7264, Val 0.6085, Test 0.6174
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 29: Loss:            : Train 0.5306, Val 0.7027, Test 0.6847
          Accuracy         : Train 0.7277, Val 0.6060, Test 0.6188
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 30: Loss:            : Train 0.5280, Val 0.7052, Test 0.6911
          Accuracy         : Train 0.7297, Val 0.6058, Test 0.6171
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 31: Loss:            : Train 0.5252, Val 0.7028, Test 0.6884
          Accuracy         : Train 0.7316, Val 0.6088, Test 0.6144
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 32: Loss:            : Train 0.5220, Val 0.7048, Test 0.6895
          Accuracy         : Train 0.7332, Val 0.6035, Test 0.6132
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 33: Loss:            : Train 0.5192, Val 0.7156, Test 0.6994
          Accuracy         : Train 0.7359, Val 0.5974, Test 0.6099
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 34: Loss:            : Train 0.5169, Val 0.7264, Test 0.7081
          Accuracy         : Train 0.7385, Val 0.5995, Test 0.6099
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 35: Loss:            : Train 0.5134, Val 0.7303, Test 0.7067
          Accuracy         : Train 0.7396, Val 0.6041, Test 0.6124
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 36: Loss:            : Train 0.5113, Val 0.7352, Test 0.7147
          Accuracy         : Train 0.7414, Val 0.5973, Test 0.6110
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 37: Loss:            : Train 0.5086, Val 0.7344, Test 0.7147
          Accuracy         : Train 0.7456, Val 0.5955, Test 0.6103
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 38: Loss:            : Train 0.5065, Val 0.7317, Test 0.7194
          Accuracy         : Train 0.7475, Val 0.6005, Test 0.6107
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 39: Loss:            : Train 0.5028, Val 0.7548, Test 0.7316
          Accuracy         : Train 0.7481, Val 0.5902, Test 0.6039
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 40: Loss:            : Train 0.5010, Val 0.7524, Test 0.7306
          Accuracy         : Train 0.7508, Val 0.5972, Test 0.6099
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 41: Loss:            : Train 0.4996, Val 0.7581, Test 0.7356
          Accuracy         : Train 0.7517, Val 0.6025, Test 0.6130
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 42: Loss:            : Train 0.4958, Val 0.7765, Test 0.7533
          Accuracy         : Train 0.7525, Val 0.5889, Test 0.5972
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 43: Loss:            : Train 0.4941, Val 0.7650, Test 0.7461
          Accuracy         : Train 0.7544, Val 0.5945, Test 0.6053
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 44: Loss:            : Train 0.4901, Val 0.7816, Test 0.7607
          Accuracy         : Train 0.7575, Val 0.6005, Test 0.6099
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 45: Loss:            : Train 0.4875, Val 0.7811, Test 0.7573
          Accuracy         : Train 0.7579, Val 0.5921, Test 0.6067
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 46: Loss:            : Train 0.4847, Val 0.7921, Test 0.7723
          Accuracy         : Train 0.7600, Val 0.5905, Test 0.6037
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 47: Loss:            : Train 0.4824, Val 0.7937, Test 0.7724
          Accuracy         : Train 0.7632, Val 0.5952, Test 0.6076
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 48: Loss:            : Train 0.4782, Val 0.8028, Test 0.7738
          Accuracy         : Train 0.7651, Val 0.5929, Test 0.6050
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 49: Loss:            : Train 0.4756, Val 0.8110, Test 0.7946
          Accuracy         : Train 0.7679, Val 0.5966, Test 0.6080
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Epoch 50: Loss:            : Train 0.4720, Val 0.8002, Test 0.7878
          Accuracy         : Train 0.7686, Val 0.5930, Test 0.6058
Best:
          Accuracy         : Train 0.6609, Val 0.6309, Test 0.6373
Training time (sec): 1591
