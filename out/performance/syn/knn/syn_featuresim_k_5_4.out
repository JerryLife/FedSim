Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 5
Generating top 5 dataset
Generating top 5 dataset
Generating top 5 dataset
Preparing time (sec): 6
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-30-12-53-36
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:2
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-30-12-53-36.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7fe52f92ac10>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7fe52f92ac40>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=5
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=5
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6536, Val 0.6368, Test 0.6329
          Accuracy         : Train 0.5994, Val 0.6255, Test 0.6308
Best:
          Accuracy         : Train 0.5994, Val 0.6255, Test 0.6308
Epoch 2: Loss:            : Train 0.6284, Val 0.6305, Test 0.6255
          Accuracy         : Train 0.6380, Val 0.6298, Test 0.6361
Best:
          Accuracy         : Train 0.6380, Val 0.6298, Test 0.6361
Epoch 3: Loss:            : Train 0.6203, Val 0.6297, Test 0.6235
          Accuracy         : Train 0.6475, Val 0.6342, Test 0.6399
Best:
          Accuracy         : Train 0.6475, Val 0.6342, Test 0.6399
Epoch 4: Loss:            : Train 0.6135, Val 0.6259, Test 0.6191
          Accuracy         : Train 0.6550, Val 0.6393, Test 0.6460
Best:
          Accuracy         : Train 0.6550, Val 0.6393, Test 0.6460
Epoch 5: Loss:            : Train 0.6071, Val 0.6226, Test 0.6167
          Accuracy         : Train 0.6615, Val 0.6436, Test 0.6480
Best:
          Accuracy         : Train 0.6615, Val 0.6436, Test 0.6480
Epoch 6: Loss:            : Train 0.6007, Val 0.6214, Test 0.6154
          Accuracy         : Train 0.6686, Val 0.6453, Test 0.6489
Best:
          Accuracy         : Train 0.6686, Val 0.6453, Test 0.6489
Epoch 7: Loss:            : Train 0.5956, Val 0.6282, Test 0.6217
          Accuracy         : Train 0.6731, Val 0.6414, Test 0.6444
Best:
          Accuracy         : Train 0.6686, Val 0.6453, Test 0.6489
Epoch 8: Loss:            : Train 0.5899, Val 0.6212, Test 0.6137
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 9: Loss:            : Train 0.5846, Val 0.6231, Test 0.6159
          Accuracy         : Train 0.6836, Val 0.6465, Test 0.6498
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 10: Loss:            : Train 0.5805, Val 0.6250, Test 0.6170
          Accuracy         : Train 0.6869, Val 0.6459, Test 0.6519
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 11: Loss:            : Train 0.5758, Val 0.6272, Test 0.6164
          Accuracy         : Train 0.6907, Val 0.6435, Test 0.6512
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 12: Loss:            : Train 0.5717, Val 0.6294, Test 0.6220
          Accuracy         : Train 0.6944, Val 0.6462, Test 0.6483
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 13: Loss:            : Train 0.5677, Val 0.6407, Test 0.6290
          Accuracy         : Train 0.6986, Val 0.6392, Test 0.6461
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 14: Loss:            : Train 0.5634, Val 0.6467, Test 0.6355
          Accuracy         : Train 0.7016, Val 0.6360, Test 0.6422
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 15: Loss:            : Train 0.5598, Val 0.6406, Test 0.6291
          Accuracy         : Train 0.7058, Val 0.6399, Test 0.6475
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 16: Loss:            : Train 0.5565, Val 0.6430, Test 0.6313
          Accuracy         : Train 0.7080, Val 0.6414, Test 0.6480
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 17: Loss:            : Train 0.5525, Val 0.6463, Test 0.6340
          Accuracy         : Train 0.7113, Val 0.6370, Test 0.6433
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 18: Loss:            : Train 0.5498, Val 0.6463, Test 0.6361
          Accuracy         : Train 0.7133, Val 0.6331, Test 0.6414
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 19: Loss:            : Train 0.5451, Val 0.6574, Test 0.6423
          Accuracy         : Train 0.7166, Val 0.6369, Test 0.6418
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 20: Loss:            : Train 0.5424, Val 0.6603, Test 0.6493
          Accuracy         : Train 0.7165, Val 0.6368, Test 0.6411
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 21: Loss:            : Train 0.5403, Val 0.6713, Test 0.6555
          Accuracy         : Train 0.7208, Val 0.6232, Test 0.6353
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 22: Loss:            : Train 0.5371, Val 0.6614, Test 0.6470
          Accuracy         : Train 0.7220, Val 0.6352, Test 0.6410
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 23: Loss:            : Train 0.5336, Val 0.6653, Test 0.6479
          Accuracy         : Train 0.7256, Val 0.6307, Test 0.6384
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 24: Loss:            : Train 0.5314, Val 0.6826, Test 0.6612
          Accuracy         : Train 0.7276, Val 0.6322, Test 0.6415
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 25: Loss:            : Train 0.5290, Val 0.6673, Test 0.6509
          Accuracy         : Train 0.7289, Val 0.6249, Test 0.6354
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 26: Loss:            : Train 0.5258, Val 0.6776, Test 0.6618
          Accuracy         : Train 0.7310, Val 0.6287, Test 0.6378
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 27: Loss:            : Train 0.5232, Val 0.6799, Test 0.6636
          Accuracy         : Train 0.7335, Val 0.6271, Test 0.6372
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 28: Loss:            : Train 0.5205, Val 0.6778, Test 0.6650
          Accuracy         : Train 0.7352, Val 0.6252, Test 0.6346
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 29: Loss:            : Train 0.5186, Val 0.6966, Test 0.6794
          Accuracy         : Train 0.7371, Val 0.6203, Test 0.6287
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 30: Loss:            : Train 0.5155, Val 0.6920, Test 0.6761
          Accuracy         : Train 0.7385, Val 0.6253, Test 0.6347
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 31: Loss:            : Train 0.5127, Val 0.6948, Test 0.6763
          Accuracy         : Train 0.7397, Val 0.6288, Test 0.6362
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 32: Loss:            : Train 0.5110, Val 0.6910, Test 0.6740
          Accuracy         : Train 0.7421, Val 0.6248, Test 0.6351
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 33: Loss:            : Train 0.5081, Val 0.6932, Test 0.6751
          Accuracy         : Train 0.7439, Val 0.6218, Test 0.6311
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 34: Loss:            : Train 0.5051, Val 0.7131, Test 0.6950
          Accuracy         : Train 0.7464, Val 0.6133, Test 0.6244
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 35: Loss:            : Train 0.5030, Val 0.7120, Test 0.7035
          Accuracy         : Train 0.7483, Val 0.6124, Test 0.6214
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 36: Loss:            : Train 0.4997, Val 0.7113, Test 0.6937
          Accuracy         : Train 0.7493, Val 0.6196, Test 0.6308
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 37: Loss:            : Train 0.4987, Val 0.7183, Test 0.7055
          Accuracy         : Train 0.7508, Val 0.6146, Test 0.6233
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 38: Loss:            : Train 0.4958, Val 0.7137, Test 0.6991
          Accuracy         : Train 0.7527, Val 0.6181, Test 0.6243
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 39: Loss:            : Train 0.4946, Val 0.7210, Test 0.7099
          Accuracy         : Train 0.7538, Val 0.6159, Test 0.6187
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 40: Loss:            : Train 0.4909, Val 0.7307, Test 0.7163
          Accuracy         : Train 0.7565, Val 0.6171, Test 0.6247
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 41: Loss:            : Train 0.4899, Val 0.7337, Test 0.7232
          Accuracy         : Train 0.7566, Val 0.6161, Test 0.6198
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 42: Loss:            : Train 0.4867, Val 0.7289, Test 0.7145
          Accuracy         : Train 0.7583, Val 0.6163, Test 0.6241
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 43: Loss:            : Train 0.4835, Val 0.7367, Test 0.7208
          Accuracy         : Train 0.7610, Val 0.6150, Test 0.6225
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 44: Loss:            : Train 0.4828, Val 0.7398, Test 0.7311
          Accuracy         : Train 0.7613, Val 0.6167, Test 0.6210
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 45: Loss:            : Train 0.4797, Val 0.7654, Test 0.7499
          Accuracy         : Train 0.7645, Val 0.6124, Test 0.6176
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 46: Loss:            : Train 0.4765, Val 0.7486, Test 0.7360
          Accuracy         : Train 0.7663, Val 0.6100, Test 0.6180
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 47: Loss:            : Train 0.4741, Val 0.7684, Test 0.7495
          Accuracy         : Train 0.7673, Val 0.6114, Test 0.6228
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 48: Loss:            : Train 0.4713, Val 0.7637, Test 0.7434
          Accuracy         : Train 0.7696, Val 0.6111, Test 0.6213
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 49: Loss:            : Train 0.4692, Val 0.7632, Test 0.7520
          Accuracy         : Train 0.7714, Val 0.6141, Test 0.6220
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Epoch 50: Loss:            : Train 0.4674, Val 0.7749, Test 0.7552
          Accuracy         : Train 0.7723, Val 0.6143, Test 0.6233
Best:
          Accuracy         : Train 0.6792, Val 0.6477, Test 0.6514
Training time (sec): 1505
