Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Preparing time (sec): 5
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-30-02-07-31
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:0
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-30-02-07-31.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7f1b3dd89e20>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7f1b3dd89e80>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=100
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=None
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6568, Val 0.6443, Test 0.6410
          Accuracy         : Train 0.5966, Val 0.6152, Test 0.6161
Best:
          Accuracy         : Train 0.5966, Val 0.6152, Test 0.6161
Epoch 2: Loss:            : Train 0.6356, Val 0.6404, Test 0.6371
          Accuracy         : Train 0.6297, Val 0.6209, Test 0.6228
Best:
          Accuracy         : Train 0.6297, Val 0.6209, Test 0.6228
Epoch 3: Loss:            : Train 0.6284, Val 0.6413, Test 0.6367
          Accuracy         : Train 0.6377, Val 0.6192, Test 0.6232
Best:
          Accuracy         : Train 0.6297, Val 0.6209, Test 0.6228
Epoch 4: Loss:            : Train 0.6232, Val 0.6422, Test 0.6338
          Accuracy         : Train 0.6438, Val 0.6238, Test 0.6288
Best:
          Accuracy         : Train 0.6438, Val 0.6238, Test 0.6288
Epoch 5: Loss:            : Train 0.6180, Val 0.6386, Test 0.6321
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 6: Loss:            : Train 0.6130, Val 0.6396, Test 0.6311
          Accuracy         : Train 0.6542, Val 0.6253, Test 0.6317
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 7: Loss:            : Train 0.6084, Val 0.6385, Test 0.6295
          Accuracy         : Train 0.6592, Val 0.6243, Test 0.6337
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 8: Loss:            : Train 0.6031, Val 0.6461, Test 0.6368
          Accuracy         : Train 0.6639, Val 0.6222, Test 0.6301
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 9: Loss:            : Train 0.5995, Val 0.6433, Test 0.6335
          Accuracy         : Train 0.6689, Val 0.6255, Test 0.6357
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 10: Loss:            : Train 0.5949, Val 0.6458, Test 0.6356
          Accuracy         : Train 0.6739, Val 0.6226, Test 0.6308
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 11: Loss:            : Train 0.5910, Val 0.6473, Test 0.6386
          Accuracy         : Train 0.6774, Val 0.6224, Test 0.6326
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 12: Loss:            : Train 0.5870, Val 0.6559, Test 0.6455
          Accuracy         : Train 0.6797, Val 0.6211, Test 0.6312
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 13: Loss:            : Train 0.5838, Val 0.6479, Test 0.6399
          Accuracy         : Train 0.6834, Val 0.6220, Test 0.6330
Best:
          Accuracy         : Train 0.6489, Val 0.6275, Test 0.6291
Epoch 14: Loss:            : Train 0.5797, Val 0.6458, Test 0.6391
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 15: Loss:            : Train 0.5768, Val 0.6601, Test 0.6505
          Accuracy         : Train 0.6895, Val 0.6193, Test 0.6275
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 16: Loss:            : Train 0.5730, Val 0.6542, Test 0.6466
          Accuracy         : Train 0.6951, Val 0.6196, Test 0.6299
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 17: Loss:            : Train 0.5694, Val 0.6596, Test 0.6491
          Accuracy         : Train 0.6967, Val 0.6220, Test 0.6291
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 18: Loss:            : Train 0.5663, Val 0.6702, Test 0.6644
          Accuracy         : Train 0.6994, Val 0.6121, Test 0.6145
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 19: Loss:            : Train 0.5637, Val 0.6622, Test 0.6519
          Accuracy         : Train 0.6999, Val 0.6216, Test 0.6290
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 20: Loss:            : Train 0.5609, Val 0.6759, Test 0.6661
          Accuracy         : Train 0.7036, Val 0.6086, Test 0.6175
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 21: Loss:            : Train 0.5579, Val 0.6702, Test 0.6628
          Accuracy         : Train 0.7056, Val 0.6147, Test 0.6210
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 22: Loss:            : Train 0.5553, Val 0.6776, Test 0.6609
          Accuracy         : Train 0.7088, Val 0.6126, Test 0.6248
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 23: Loss:            : Train 0.5518, Val 0.6708, Test 0.6612
          Accuracy         : Train 0.7098, Val 0.6117, Test 0.6245
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 24: Loss:            : Train 0.5493, Val 0.6815, Test 0.6741
          Accuracy         : Train 0.7123, Val 0.6140, Test 0.6236
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 25: Loss:            : Train 0.5469, Val 0.6894, Test 0.6720
          Accuracy         : Train 0.7141, Val 0.6052, Test 0.6212
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 26: Loss:            : Train 0.5438, Val 0.6845, Test 0.6735
          Accuracy         : Train 0.7147, Val 0.6079, Test 0.6199
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 27: Loss:            : Train 0.5411, Val 0.7009, Test 0.6886
          Accuracy         : Train 0.7181, Val 0.6074, Test 0.6173
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 28: Loss:            : Train 0.5390, Val 0.6955, Test 0.6834
          Accuracy         : Train 0.7205, Val 0.6080, Test 0.6192
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 29: Loss:            : Train 0.5360, Val 0.6921, Test 0.6844
          Accuracy         : Train 0.7243, Val 0.6103, Test 0.6200
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 30: Loss:            : Train 0.5342, Val 0.7129, Test 0.6964
          Accuracy         : Train 0.7259, Val 0.6053, Test 0.6180
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 31: Loss:            : Train 0.5310, Val 0.7047, Test 0.6891
          Accuracy         : Train 0.7282, Val 0.6069, Test 0.6206
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 32: Loss:            : Train 0.5283, Val 0.7015, Test 0.6875
          Accuracy         : Train 0.7286, Val 0.6041, Test 0.6162
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 33: Loss:            : Train 0.5262, Val 0.7249, Test 0.7061
          Accuracy         : Train 0.7315, Val 0.6054, Test 0.6178
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 34: Loss:            : Train 0.5233, Val 0.7269, Test 0.7063
          Accuracy         : Train 0.7336, Val 0.5936, Test 0.6080
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 35: Loss:            : Train 0.5223, Val 0.7187, Test 0.7011
          Accuracy         : Train 0.7332, Val 0.5992, Test 0.6131
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 36: Loss:            : Train 0.5184, Val 0.7320, Test 0.7204
          Accuracy         : Train 0.7375, Val 0.6029, Test 0.6104
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 37: Loss:            : Train 0.5157, Val 0.7342, Test 0.7157
          Accuracy         : Train 0.7391, Val 0.5917, Test 0.6042
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 38: Loss:            : Train 0.5133, Val 0.7357, Test 0.7161
          Accuracy         : Train 0.7408, Val 0.5997, Test 0.6137
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 39: Loss:            : Train 0.5111, Val 0.7290, Test 0.7152
          Accuracy         : Train 0.7423, Val 0.6013, Test 0.6108
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 40: Loss:            : Train 0.5086, Val 0.7576, Test 0.7425
          Accuracy         : Train 0.7428, Val 0.5942, Test 0.6105
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 41: Loss:            : Train 0.5063, Val 0.7522, Test 0.7283
          Accuracy         : Train 0.7448, Val 0.5950, Test 0.6107
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 42: Loss:            : Train 0.5033, Val 0.7424, Test 0.7242
          Accuracy         : Train 0.7468, Val 0.5980, Test 0.6124
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 43: Loss:            : Train 0.5008, Val 0.7608, Test 0.7389
          Accuracy         : Train 0.7502, Val 0.5924, Test 0.6051
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 44: Loss:            : Train 0.4977, Val 0.7579, Test 0.7399
          Accuracy         : Train 0.7498, Val 0.5948, Test 0.6039
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 45: Loss:            : Train 0.4947, Val 0.7797, Test 0.7577
          Accuracy         : Train 0.7531, Val 0.5984, Test 0.6119
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 46: Loss:            : Train 0.4916, Val 0.7651, Test 0.7441
          Accuracy         : Train 0.7541, Val 0.5935, Test 0.6057
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 47: Loss:            : Train 0.4893, Val 0.7715, Test 0.7522
          Accuracy         : Train 0.7577, Val 0.5960, Test 0.6066
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 48: Loss:            : Train 0.4853, Val 0.7843, Test 0.7641
          Accuracy         : Train 0.7599, Val 0.5993, Test 0.6048
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 49: Loss:            : Train 0.4832, Val 0.7928, Test 0.7672
          Accuracy         : Train 0.7612, Val 0.5960, Test 0.6099
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Epoch 50: Loss:            : Train 0.4808, Val 0.7837, Test 0.7603
          Accuracy         : Train 0.7643, Val 0.5985, Test 0.6088
Best:
          Accuracy         : Train 0.6867, Val 0.6286, Test 0.6347
Training time (sec): 1705
