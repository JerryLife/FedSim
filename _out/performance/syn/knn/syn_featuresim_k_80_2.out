Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 80
Generating top 80 dataset
Generating top 80 dataset
Generating top 80 dataset
Preparing time (sec): 22
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-27-17-53-40
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:2
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-27-17-53-40.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7fb4289fdc10>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7fb4289fdc40>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=80
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=80
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6564, Val 0.6458, Test 0.6433
          Accuracy         : Train 0.5967, Val 0.6129, Test 0.6123
Best:
          Accuracy         : Train 0.5967, Val 0.6129, Test 0.6123
Epoch 2: Loss:            : Train 0.6365, Val 0.6457, Test 0.6395
          Accuracy         : Train 0.6257, Val 0.6136, Test 0.6170
Best:
          Accuracy         : Train 0.6257, Val 0.6136, Test 0.6170
Epoch 3: Loss:            : Train 0.6310, Val 0.6436, Test 0.6367
          Accuracy         : Train 0.6342, Val 0.6146, Test 0.6207
Best:
          Accuracy         : Train 0.6342, Val 0.6146, Test 0.6207
Epoch 4: Loss:            : Train 0.6263, Val 0.6411, Test 0.6360
          Accuracy         : Train 0.6393, Val 0.6157, Test 0.6206
Best:
          Accuracy         : Train 0.6393, Val 0.6157, Test 0.6206
Epoch 5: Loss:            : Train 0.6210, Val 0.6409, Test 0.6357
          Accuracy         : Train 0.6454, Val 0.6148, Test 0.6235
Best:
          Accuracy         : Train 0.6393, Val 0.6157, Test 0.6206
Epoch 6: Loss:            : Train 0.6155, Val 0.6429, Test 0.6347
          Accuracy         : Train 0.6513, Val 0.6213, Test 0.6252
Best:
          Accuracy         : Train 0.6513, Val 0.6213, Test 0.6252
Epoch 7: Loss:            : Train 0.6099, Val 0.6389, Test 0.6315
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 8: Loss:            : Train 0.6045, Val 0.6409, Test 0.6325
          Accuracy         : Train 0.6627, Val 0.6220, Test 0.6284
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 9: Loss:            : Train 0.5998, Val 0.6460, Test 0.6336
          Accuracy         : Train 0.6680, Val 0.6179, Test 0.6274
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 10: Loss:            : Train 0.5952, Val 0.6404, Test 0.6329
          Accuracy         : Train 0.6721, Val 0.6202, Test 0.6290
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 11: Loss:            : Train 0.5910, Val 0.6451, Test 0.6346
          Accuracy         : Train 0.6766, Val 0.6240, Test 0.6335
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 12: Loss:            : Train 0.5858, Val 0.6470, Test 0.6384
          Accuracy         : Train 0.6811, Val 0.6224, Test 0.6291
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 13: Loss:            : Train 0.5823, Val 0.6526, Test 0.6410
          Accuracy         : Train 0.6848, Val 0.6202, Test 0.6301
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 14: Loss:            : Train 0.5785, Val 0.6520, Test 0.6460
          Accuracy         : Train 0.6887, Val 0.6219, Test 0.6281
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 15: Loss:            : Train 0.5748, Val 0.6581, Test 0.6519
          Accuracy         : Train 0.6898, Val 0.6187, Test 0.6252
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 16: Loss:            : Train 0.5715, Val 0.6604, Test 0.6514
          Accuracy         : Train 0.6929, Val 0.6195, Test 0.6278
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 17: Loss:            : Train 0.5675, Val 0.6601, Test 0.6478
          Accuracy         : Train 0.6972, Val 0.6134, Test 0.6219
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 18: Loss:            : Train 0.5638, Val 0.6712, Test 0.6605
          Accuracy         : Train 0.7001, Val 0.6126, Test 0.6188
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 19: Loss:            : Train 0.5605, Val 0.6702, Test 0.6617
          Accuracy         : Train 0.7018, Val 0.6217, Test 0.6210
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 20: Loss:            : Train 0.5574, Val 0.6740, Test 0.6632
          Accuracy         : Train 0.7038, Val 0.6188, Test 0.6222
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 21: Loss:            : Train 0.5546, Val 0.6740, Test 0.6662
          Accuracy         : Train 0.7064, Val 0.6204, Test 0.6234
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 22: Loss:            : Train 0.5513, Val 0.6760, Test 0.6669
          Accuracy         : Train 0.7094, Val 0.6217, Test 0.6216
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 23: Loss:            : Train 0.5487, Val 0.6743, Test 0.6665
          Accuracy         : Train 0.7120, Val 0.6185, Test 0.6251
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 24: Loss:            : Train 0.5454, Val 0.6963, Test 0.6857
          Accuracy         : Train 0.7150, Val 0.6125, Test 0.6177
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 25: Loss:            : Train 0.5420, Val 0.6710, Test 0.6643
          Accuracy         : Train 0.7178, Val 0.6112, Test 0.6179
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 26: Loss:            : Train 0.5398, Val 0.6895, Test 0.6800
          Accuracy         : Train 0.7186, Val 0.6151, Test 0.6209
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 27: Loss:            : Train 0.5373, Val 0.6911, Test 0.6833
          Accuracy         : Train 0.7223, Val 0.6114, Test 0.6165
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 28: Loss:            : Train 0.5336, Val 0.6947, Test 0.6897
          Accuracy         : Train 0.7247, Val 0.6143, Test 0.6179
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 29: Loss:            : Train 0.5317, Val 0.7088, Test 0.6945
          Accuracy         : Train 0.7245, Val 0.6046, Test 0.6115
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 30: Loss:            : Train 0.5283, Val 0.7002, Test 0.6939
          Accuracy         : Train 0.7276, Val 0.6099, Test 0.6146
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 31: Loss:            : Train 0.5248, Val 0.7156, Test 0.7050
          Accuracy         : Train 0.7308, Val 0.6093, Test 0.6147
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 32: Loss:            : Train 0.5213, Val 0.7180, Test 0.7115
          Accuracy         : Train 0.7346, Val 0.6144, Test 0.6152
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 33: Loss:            : Train 0.5184, Val 0.7152, Test 0.7105
          Accuracy         : Train 0.7378, Val 0.6073, Test 0.6082
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 34: Loss:            : Train 0.5154, Val 0.7337, Test 0.7250
          Accuracy         : Train 0.7393, Val 0.6104, Test 0.6162
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 35: Loss:            : Train 0.5125, Val 0.7293, Test 0.7254
          Accuracy         : Train 0.7402, Val 0.6083, Test 0.6104
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 36: Loss:            : Train 0.5091, Val 0.7398, Test 0.7297
          Accuracy         : Train 0.7427, Val 0.6029, Test 0.6060
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 37: Loss:            : Train 0.5059, Val 0.7469, Test 0.7423
          Accuracy         : Train 0.7436, Val 0.6107, Test 0.6078
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 38: Loss:            : Train 0.5037, Val 0.7387, Test 0.7303
          Accuracy         : Train 0.7460, Val 0.6057, Test 0.6094
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 39: Loss:            : Train 0.5019, Val 0.7422, Test 0.7380
          Accuracy         : Train 0.7480, Val 0.6024, Test 0.6053
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 40: Loss:            : Train 0.4973, Val 0.7469, Test 0.7443
          Accuracy         : Train 0.7517, Val 0.6020, Test 0.6025
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 41: Loss:            : Train 0.4951, Val 0.7607, Test 0.7479
          Accuracy         : Train 0.7552, Val 0.6003, Test 0.6056
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 42: Loss:            : Train 0.4900, Val 0.7697, Test 0.7619
          Accuracy         : Train 0.7576, Val 0.5973, Test 0.5977
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 43: Loss:            : Train 0.4872, Val 0.8010, Test 0.7902
          Accuracy         : Train 0.7585, Val 0.6015, Test 0.6065
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 44: Loss:            : Train 0.4849, Val 0.7788, Test 0.7724
          Accuracy         : Train 0.7609, Val 0.6062, Test 0.6023
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 45: Loss:            : Train 0.4806, Val 0.7971, Test 0.7886
          Accuracy         : Train 0.7645, Val 0.6072, Test 0.6034
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 46: Loss:            : Train 0.4775, Val 0.8018, Test 0.7911
          Accuracy         : Train 0.7653, Val 0.5954, Test 0.5984
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 47: Loss:            : Train 0.4739, Val 0.7888, Test 0.7859
          Accuracy         : Train 0.7689, Val 0.5997, Test 0.6026
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 48: Loss:            : Train 0.4709, Val 0.7949, Test 0.7921
          Accuracy         : Train 0.7715, Val 0.5973, Test 0.5975
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 49: Loss:            : Train 0.4667, Val 0.8123, Test 0.7940
          Accuracy         : Train 0.7728, Val 0.5983, Test 0.6050
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Epoch 50: Loss:            : Train 0.4642, Val 0.8196, Test 0.8044
          Accuracy         : Train 0.7748, Val 0.5955, Test 0.5987
Best:
          Accuracy         : Train 0.6570, Val 0.6253, Test 0.6291
Training time (sec): 2526
