Loading data from cache
Done
Calculating noise scale
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Adding noise of scale 0.0 to sim_scores
Filter dataset to top 40
Generating top 40 dataset
Generating top 40 dataset
Generating top 40 dataset
Preparing time (sec): 23
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-27-15-30-59
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:2
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-27-15-30-59.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7f0fc5718a60>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7f0fc5718a90>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=40
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=40
link_n_jobs=1
psig_p=7
sim_leak_p=1.0
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=None
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6571, Val 0.6431, Test 0.6411
          Accuracy         : Train 0.5943, Val 0.6167, Test 0.6180
Best:
          Accuracy         : Train 0.5943, Val 0.6167, Test 0.6180
Epoch 2: Loss:            : Train 0.6356, Val 0.6403, Test 0.6380
          Accuracy         : Train 0.6279, Val 0.6190, Test 0.6218
Best:
          Accuracy         : Train 0.6279, Val 0.6190, Test 0.6218
Epoch 3: Loss:            : Train 0.6287, Val 0.6367, Test 0.6328
          Accuracy         : Train 0.6357, Val 0.6200, Test 0.6286
Best:
          Accuracy         : Train 0.6357, Val 0.6200, Test 0.6286
Epoch 4: Loss:            : Train 0.6234, Val 0.6369, Test 0.6326
          Accuracy         : Train 0.6429, Val 0.6211, Test 0.6302
Best:
          Accuracy         : Train 0.6429, Val 0.6211, Test 0.6302
Epoch 5: Loss:            : Train 0.6176, Val 0.6332, Test 0.6295
          Accuracy         : Train 0.6487, Val 0.6239, Test 0.6341
Best:
          Accuracy         : Train 0.6487, Val 0.6239, Test 0.6341
Epoch 6: Loss:            : Train 0.6123, Val 0.6338, Test 0.6299
          Accuracy         : Train 0.6547, Val 0.6247, Test 0.6348
Best:
          Accuracy         : Train 0.6547, Val 0.6247, Test 0.6348
Epoch 7: Loss:            : Train 0.6075, Val 0.6334, Test 0.6306
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Best:
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Epoch 8: Loss:            : Train 0.6030, Val 0.6366, Test 0.6321
          Accuracy         : Train 0.6640, Val 0.6242, Test 0.6356
Best:
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Epoch 9: Loss:            : Train 0.5986, Val 0.6363, Test 0.6316
          Accuracy         : Train 0.6695, Val 0.6237, Test 0.6343
Best:
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Epoch 10: Loss:            : Train 0.5935, Val 0.6435, Test 0.6378
          Accuracy         : Train 0.6737, Val 0.6230, Test 0.6289
Best:
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Epoch 11: Loss:            : Train 0.5899, Val 0.6373, Test 0.6327
          Accuracy         : Train 0.6777, Val 0.6263, Test 0.6345
Best:
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Epoch 12: Loss:            : Train 0.5857, Val 0.6502, Test 0.6399
          Accuracy         : Train 0.6810, Val 0.6175, Test 0.6337
Best:
          Accuracy         : Train 0.6607, Val 0.6289, Test 0.6354
Epoch 13: Loss:            : Train 0.5817, Val 0.6415, Test 0.6374
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 14: Loss:            : Train 0.5779, Val 0.6465, Test 0.6437
          Accuracy         : Train 0.6878, Val 0.6213, Test 0.6252
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 15: Loss:            : Train 0.5746, Val 0.6457, Test 0.6387
          Accuracy         : Train 0.6903, Val 0.6212, Test 0.6324
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 16: Loss:            : Train 0.5713, Val 0.6518, Test 0.6408
          Accuracy         : Train 0.6935, Val 0.6227, Test 0.6359
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 17: Loss:            : Train 0.5679, Val 0.6562, Test 0.6506
          Accuracy         : Train 0.6967, Val 0.6224, Test 0.6262
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 18: Loss:            : Train 0.5644, Val 0.6591, Test 0.6502
          Accuracy         : Train 0.7010, Val 0.6221, Test 0.6297
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 19: Loss:            : Train 0.5620, Val 0.6578, Test 0.6507
          Accuracy         : Train 0.7021, Val 0.6172, Test 0.6250
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 20: Loss:            : Train 0.5586, Val 0.6602, Test 0.6570
          Accuracy         : Train 0.7045, Val 0.6189, Test 0.6224
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 21: Loss:            : Train 0.5563, Val 0.6611, Test 0.6522
          Accuracy         : Train 0.7093, Val 0.6240, Test 0.6295
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 22: Loss:            : Train 0.5521, Val 0.6707, Test 0.6604
          Accuracy         : Train 0.7125, Val 0.6175, Test 0.6285
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 23: Loss:            : Train 0.5497, Val 0.6808, Test 0.6753
          Accuracy         : Train 0.7122, Val 0.6149, Test 0.6188
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 24: Loss:            : Train 0.5470, Val 0.6727, Test 0.6634
          Accuracy         : Train 0.7149, Val 0.6172, Test 0.6232
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 25: Loss:            : Train 0.5448, Val 0.6700, Test 0.6651
          Accuracy         : Train 0.7182, Val 0.6170, Test 0.6234
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 26: Loss:            : Train 0.5414, Val 0.6756, Test 0.6689
          Accuracy         : Train 0.7196, Val 0.6188, Test 0.6218
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 27: Loss:            : Train 0.5381, Val 0.6784, Test 0.6758
          Accuracy         : Train 0.7210, Val 0.6162, Test 0.6219
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 28: Loss:            : Train 0.5357, Val 0.6961, Test 0.6898
          Accuracy         : Train 0.7238, Val 0.6089, Test 0.6192
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 29: Loss:            : Train 0.5328, Val 0.7028, Test 0.6931
          Accuracy         : Train 0.7259, Val 0.6125, Test 0.6179
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 30: Loss:            : Train 0.5306, Val 0.7021, Test 0.6979
          Accuracy         : Train 0.7268, Val 0.6170, Test 0.6149
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 31: Loss:            : Train 0.5280, Val 0.6911, Test 0.6840
          Accuracy         : Train 0.7293, Val 0.6177, Test 0.6174
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 32: Loss:            : Train 0.5249, Val 0.7067, Test 0.7007
          Accuracy         : Train 0.7316, Val 0.6102, Test 0.6151
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 33: Loss:            : Train 0.5221, Val 0.7127, Test 0.7064
          Accuracy         : Train 0.7342, Val 0.6111, Test 0.6176
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 34: Loss:            : Train 0.5194, Val 0.7142, Test 0.7030
          Accuracy         : Train 0.7372, Val 0.6085, Test 0.6168
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 35: Loss:            : Train 0.5175, Val 0.7126, Test 0.7032
          Accuracy         : Train 0.7380, Val 0.6092, Test 0.6161
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 36: Loss:            : Train 0.5148, Val 0.7250, Test 0.7148
          Accuracy         : Train 0.7380, Val 0.6002, Test 0.6107
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 37: Loss:            : Train 0.5120, Val 0.7390, Test 0.7317
          Accuracy         : Train 0.7412, Val 0.6076, Test 0.6110
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 38: Loss:            : Train 0.5094, Val 0.7393, Test 0.7328
          Accuracy         : Train 0.7434, Val 0.6094, Test 0.6123
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 39: Loss:            : Train 0.5065, Val 0.7426, Test 0.7368
          Accuracy         : Train 0.7457, Val 0.6038, Test 0.6071
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 40: Loss:            : Train 0.5042, Val 0.7451, Test 0.7356
          Accuracy         : Train 0.7472, Val 0.6080, Test 0.6102
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 41: Loss:            : Train 0.5007, Val 0.7433, Test 0.7377
          Accuracy         : Train 0.7496, Val 0.6111, Test 0.6100
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 42: Loss:            : Train 0.4993, Val 0.7450, Test 0.7351
          Accuracy         : Train 0.7504, Val 0.6043, Test 0.6036
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 43: Loss:            : Train 0.4951, Val 0.7613, Test 0.7539
          Accuracy         : Train 0.7529, Val 0.6069, Test 0.6112
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 44: Loss:            : Train 0.4924, Val 0.7817, Test 0.7729
          Accuracy         : Train 0.7558, Val 0.5921, Test 0.6003
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 45: Loss:            : Train 0.4895, Val 0.7629, Test 0.7545
          Accuracy         : Train 0.7576, Val 0.6040, Test 0.6121
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 46: Loss:            : Train 0.4870, Val 0.7780, Test 0.7669
          Accuracy         : Train 0.7588, Val 0.5970, Test 0.6041
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 47: Loss:            : Train 0.4841, Val 0.7847, Test 0.7694
          Accuracy         : Train 0.7607, Val 0.5962, Test 0.6077
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 48: Loss:            : Train 0.4801, Val 0.7881, Test 0.7896
          Accuracy         : Train 0.7647, Val 0.6064, Test 0.6041
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 49: Loss:            : Train 0.4773, Val 0.7904, Test 0.7752
          Accuracy         : Train 0.7655, Val 0.5998, Test 0.6070
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Epoch 50: Loss:            : Train 0.4747, Val 0.7900, Test 0.7871
          Accuracy         : Train 0.7680, Val 0.6011, Test 0.5998
Best:
          Accuracy         : Train 0.6845, Val 0.6289, Test 0.6330
Training time (sec): 2462
