Loading data from cache
Done
Calculating noise scale
Standard variance of sim_score: 518.95
Adding noise of scale 0.0076674861202183165 to sim_scores
Adding noise of scale 0.0076674861202183165 to sim_scores
Adding noise of scale 0.0076674861202183165 to sim_scores
Preparing time (sec): 3
Initializing dataloader
Done
Prepare for training
Start training
================================================================================
                                    Kernel Shape Output Shape  Params  \
Layer                                                                   
0_local_models.0.fc_layers.Linear_0    [46, 100]    [32, 100]    4700   
1_local_models.0.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
2_local_models.1.fc_layers.Linear_0    [45, 100]    [32, 100]    4600   
3_local_models.1.fc_layers.Linear_1    [100, 50]     [32, 50]    5050   
4_agg_model.fc_layers.Linear_0        [100, 100]    [32, 100]   10100   
5_agg_model.fc_layers.Linear_1          [100, 1]      [32, 1]     101   

                                     Mult-Adds  
Layer                                           
0_local_models.0.fc_layers.Linear_0       4600  
1_local_models.0.fc_layers.Linear_1       5000  
2_local_models.1.fc_layers.Linear_0       4500  
3_local_models.1.fc_layers.Linear_1       5000  
4_agg_model.fc_layers.Linear_0           10000  
5_agg_model.fc_layers.Linear_1             100  
--------------------------------------------------------------------------------
                      Totals
Total params           29601
Trainable params       29601
Non-trainable params       0
Mult-Adds              29200
================================================================================
n_classes=2
task=binary_cls
model_name=syn_featuresim_noise_0.2_2022-01-23-15-30-07
sche_threshold=0.0001
sche_patience=10
sche_factor=0.1
use_scheduler=False
num_workers=4
device=cuda:0
test_batch_size=4096
train_batch_size=32
learning_rate=0.001
weight_decay=0.0001
num_epochs=50
model_save_path=ckp/syn_featuresim_noise_0.2_2022-01-23-15-30-07.pth
test_rate=0.2
val_rate=0.1
multiprocess_context=fork
metrics=['accuracy']
metrics_f=[<metric.accuracy.Accuracy object at 0x7fe86b329c70>]
hidden_sizes=[100, 100]
model=SplitNN(
  (agg_model): MLP(
    (fc_layers): ModuleList(
      (0): Linear(in_features=100, out_features=100, bias=True)
      (1): Linear(in_features=100, out_features=1, bias=True)
    )
  )
  (local_models): ModuleList(
    (0): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=46, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
    (1): MLP(
      (fc_layers): ModuleList(
        (0): Linear(in_features=45, out_features=100, bias=True)
        (1): Linear(in_features=100, out_features=50, bias=True)
      )
    )
  )
)
writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x7fe86b329ca0>
dataset_type=syn
drop_key=True
num_common_features=5
tree_radius=2
tree_leaf_size=1000
knn_k=100
grid_min=-10.0
grid_max=10.0
grid_width=1.5
sim_scaler=StandardScaler()
filter_top_k=None
link_n_jobs=1
psig_p=7
sim_leak_p=0.1
link_threshold_t=0.1
link_epsilon=0.1
n_hash_lsh=20
edit_distance_threshold=1
n_hash_func=10
collision_rate=0.05
qgram_q=2
link_delta=0.1
feature_wise_sim=False
blocking_method=knn_priv_str
center_threshold=0.5
n_clusters=100
local_hidden_sizes=[[100], [100]]
cut_dims=[50, 50]
agg_hidden_sizes=[100]
scale_analysis=<utils.privacy.SimNoiseScale object at 0x7fe9714c13a0>
data1_shape=(60000, 50)
data2_shape=(60000, 50)
Epoch 1: Loss:            : Train 0.6592, Val 0.6457, Test 0.6438
          Accuracy         : Train 0.5930, Val 0.6093, Test 0.6131
Best:
          Accuracy         : Train 0.5930, Val 0.6093, Test 0.6131
Epoch 2: Loss:            : Train 0.6377, Val 0.6415, Test 0.6389
          Accuracy         : Train 0.6264, Val 0.6164, Test 0.6204
Best:
          Accuracy         : Train 0.6264, Val 0.6164, Test 0.6204
Epoch 3: Loss:            : Train 0.6307, Val 0.6392, Test 0.6365
          Accuracy         : Train 0.6359, Val 0.6174, Test 0.6225
Best:
          Accuracy         : Train 0.6359, Val 0.6174, Test 0.6225
Epoch 4: Loss:            : Train 0.6249, Val 0.6356, Test 0.6324
          Accuracy         : Train 0.6403, Val 0.6239, Test 0.6263
Best:
          Accuracy         : Train 0.6403, Val 0.6239, Test 0.6263
Epoch 5: Loss:            : Train 0.6195, Val 0.6351, Test 0.6320
          Accuracy         : Train 0.6472, Val 0.6230, Test 0.6277
Best:
          Accuracy         : Train 0.6403, Val 0.6239, Test 0.6263
Epoch 6: Loss:            : Train 0.6142, Val 0.6342, Test 0.6308
          Accuracy         : Train 0.6528, Val 0.6253, Test 0.6267
Best:
          Accuracy         : Train 0.6528, Val 0.6253, Test 0.6267
Epoch 7: Loss:            : Train 0.6095, Val 0.6403, Test 0.6352
          Accuracy         : Train 0.6593, Val 0.6252, Test 0.6258
Best:
          Accuracy         : Train 0.6528, Val 0.6253, Test 0.6267
Epoch 8: Loss:            : Train 0.6049, Val 0.6400, Test 0.6324
          Accuracy         : Train 0.6629, Val 0.6253, Test 0.6323
Best:
          Accuracy         : Train 0.6528, Val 0.6253, Test 0.6267
Epoch 9: Loss:            : Train 0.6007, Val 0.6388, Test 0.6333
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 10: Loss:            : Train 0.5965, Val 0.6386, Test 0.6315
          Accuracy         : Train 0.6696, Val 0.6253, Test 0.6327
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 11: Loss:            : Train 0.5933, Val 0.6389, Test 0.6339
          Accuracy         : Train 0.6735, Val 0.6288, Test 0.6304
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 12: Loss:            : Train 0.5893, Val 0.6433, Test 0.6362
          Accuracy         : Train 0.6750, Val 0.6237, Test 0.6323
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 13: Loss:            : Train 0.5864, Val 0.6451, Test 0.6358
          Accuracy         : Train 0.6790, Val 0.6241, Test 0.6361
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 14: Loss:            : Train 0.5832, Val 0.6454, Test 0.6372
          Accuracy         : Train 0.6811, Val 0.6265, Test 0.6337
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 15: Loss:            : Train 0.5798, Val 0.6571, Test 0.6479
          Accuracy         : Train 0.6848, Val 0.6176, Test 0.6216
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 16: Loss:            : Train 0.5768, Val 0.6504, Test 0.6411
          Accuracy         : Train 0.6883, Val 0.6185, Test 0.6295
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 17: Loss:            : Train 0.5729, Val 0.6552, Test 0.6453
          Accuracy         : Train 0.6912, Val 0.6180, Test 0.6299
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 18: Loss:            : Train 0.5709, Val 0.6673, Test 0.6575
          Accuracy         : Train 0.6941, Val 0.6105, Test 0.6225
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 19: Loss:            : Train 0.5670, Val 0.6682, Test 0.6552
          Accuracy         : Train 0.6954, Val 0.6138, Test 0.6241
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 20: Loss:            : Train 0.5640, Val 0.6736, Test 0.6604
          Accuracy         : Train 0.6990, Val 0.6107, Test 0.6287
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 21: Loss:            : Train 0.5606, Val 0.6634, Test 0.6528
          Accuracy         : Train 0.7013, Val 0.6149, Test 0.6275
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 22: Loss:            : Train 0.5576, Val 0.6735, Test 0.6620
          Accuracy         : Train 0.7034, Val 0.6094, Test 0.6226
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 23: Loss:            : Train 0.5551, Val 0.6713, Test 0.6564
          Accuracy         : Train 0.7072, Val 0.6092, Test 0.6224
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 24: Loss:            : Train 0.5523, Val 0.6822, Test 0.6692
          Accuracy         : Train 0.7086, Val 0.6153, Test 0.6251
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 25: Loss:            : Train 0.5498, Val 0.6927, Test 0.6789
          Accuracy         : Train 0.7115, Val 0.6000, Test 0.6159
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 26: Loss:            : Train 0.5461, Val 0.6866, Test 0.6758
          Accuracy         : Train 0.7133, Val 0.6069, Test 0.6203
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 27: Loss:            : Train 0.5443, Val 0.6955, Test 0.6799
          Accuracy         : Train 0.7157, Val 0.6061, Test 0.6208
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 28: Loss:            : Train 0.5412, Val 0.6957, Test 0.6807
          Accuracy         : Train 0.7175, Val 0.6009, Test 0.6157
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 29: Loss:            : Train 0.5383, Val 0.7002, Test 0.6873
          Accuracy         : Train 0.7200, Val 0.6056, Test 0.6161
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 30: Loss:            : Train 0.5358, Val 0.6989, Test 0.6821
          Accuracy         : Train 0.7235, Val 0.5993, Test 0.6143
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 31: Loss:            : Train 0.5344, Val 0.7060, Test 0.6883
          Accuracy         : Train 0.7246, Val 0.5956, Test 0.6145
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 32: Loss:            : Train 0.5306, Val 0.7109, Test 0.6915
          Accuracy         : Train 0.7281, Val 0.6002, Test 0.6160
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 33: Loss:            : Train 0.5274, Val 0.7152, Test 0.6984
          Accuracy         : Train 0.7286, Val 0.6031, Test 0.6137
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 34: Loss:            : Train 0.5243, Val 0.7182, Test 0.6971
          Accuracy         : Train 0.7320, Val 0.6028, Test 0.6149
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 35: Loss:            : Train 0.5223, Val 0.7245, Test 0.7109
          Accuracy         : Train 0.7323, Val 0.6033, Test 0.6087
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 36: Loss:            : Train 0.5197, Val 0.7241, Test 0.7079
          Accuracy         : Train 0.7337, Val 0.5951, Test 0.6084
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 37: Loss:            : Train 0.5162, Val 0.7503, Test 0.7311
          Accuracy         : Train 0.7397, Val 0.5994, Test 0.6102
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 38: Loss:            : Train 0.5135, Val 0.7526, Test 0.7359
          Accuracy         : Train 0.7384, Val 0.6046, Test 0.6134
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 39: Loss:            : Train 0.5107, Val 0.7487, Test 0.7353
          Accuracy         : Train 0.7422, Val 0.5939, Test 0.6114
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 40: Loss:            : Train 0.5073, Val 0.7438, Test 0.7356
          Accuracy         : Train 0.7422, Val 0.5939, Test 0.6016
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 41: Loss:            : Train 0.5058, Val 0.7729, Test 0.7594
          Accuracy         : Train 0.7468, Val 0.5909, Test 0.5991
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 42: Loss:            : Train 0.5008, Val 0.7737, Test 0.7540
          Accuracy         : Train 0.7485, Val 0.5922, Test 0.6099
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 43: Loss:            : Train 0.4976, Val 0.7481, Test 0.7366
          Accuracy         : Train 0.7520, Val 0.5975, Test 0.6053
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 44: Loss:            : Train 0.4936, Val 0.7792, Test 0.7613
          Accuracy         : Train 0.7544, Val 0.5854, Test 0.5996
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 45: Loss:            : Train 0.4918, Val 0.7920, Test 0.7658
          Accuracy         : Train 0.7560, Val 0.5841, Test 0.6022
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 46: Loss:            : Train 0.4886, Val 0.8164, Test 0.7949
          Accuracy         : Train 0.7581, Val 0.5829, Test 0.5987
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 47: Loss:            : Train 0.4853, Val 0.8119, Test 0.7923
          Accuracy         : Train 0.7608, Val 0.5912, Test 0.6030
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 48: Loss:            : Train 0.4817, Val 0.7958, Test 0.7785
          Accuracy         : Train 0.7626, Val 0.5875, Test 0.6031
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 49: Loss:            : Train 0.4790, Val 0.8207, Test 0.8023
          Accuracy         : Train 0.7647, Val 0.5795, Test 0.5968
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Epoch 50: Loss:            : Train 0.4760, Val 0.8161, Test 0.8108
          Accuracy         : Train 0.7682, Val 0.5932, Test 0.6028
Best:
          Accuracy         : Train 0.6654, Val 0.6305, Test 0.6321
Training time (sec): 806
